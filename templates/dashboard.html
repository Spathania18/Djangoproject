{% extends "layouts/base.html" %}
{% load static %}

{% block content %}
<div class="d-flex">
    {% include "layouts/sidebar.html" %}

    <div class="w-100">
        {% include "layouts/header.html" %}
        <div class="my-3 mx-3">
            <h1 class='text-center'>Dashboard</h1>
          

            <div class="container px-4 text-center">
                <div class="row gx-5">
                  <div class="col">
                    <div class="card text-bg-primary mb-3" style="max-width: 18rem;">
                        <div class="card-body">
                            <h4 class="card-title">Total Applications</h4>
                            <h5>{{application_count}}</h5>
                        </div>
                      </div>
                  </div>
                  <div class="col">
                    <div class="card text-bg-primary mb-3" style="max-width: 18rem;">
                        <div class="card-body">
                            <h4 class="card-title">Applications Applied Today </h4>
                            <h5>{{application_count_today}}</h5>
                        </div>
                      </div>
                  </div>
                  <div class="col">
                    <div class="card text-bg-primary mb-3" style="max-width: 18rem;">
                        <div class="card-body">
                            <h4 class="card-title">Total Companies</h4>
                            <h5>{{distinct_companies_count}}</h5>
                        </div>
                      </div>
                  </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="container text-center mt-4">
                <div class="row gx-5">
                    <div class="col">
                        <div class="card" style="width: 100%; height: 525px; max-width: 500px; margin: 10px;">
                            <div class="card-body">
                                <h4 class="card-title">Job Type Distribution</h4>
                                <canvas id="jobTypeChart" style="width: 100%; height: 200px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card" style="width: 100%; height: 525px; max-width: 500px; margin: 10px;">
                            <div class="card-body">
                                <h4 class="card-title">Applications by Company</h4>
                                <canvas id="companyChart" style="width: 100%; height: 400px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row gx-5 mt-4">
                    <div class="col">
                        <div class="card" style="width: 100%; height: 300px; max-width: 1100px; margin: 10px;">
                            <div class="card-body">
                                <h4 class="card-title">Applications by Date</h4>
                                <canvas id="dateChart" style="width: 100%; height: 250px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- Inline JavaScript for Data -->
<script>
    // Passing Django data to JavaScript
    var jobTypes = {{ jobTypes|safe }};
    var jobTypeData = {{ jobTypeData|safe }};
    var companyNames = {{ companyNames|safe }};
    var companyCounts = {{ companyCounts|safe }};
    var applicationDates = {{ applicationDates|safe }};
    var applicationDateCounts = {{ applicationDateCounts|safe }};
</script>
{% endblock content %}

{% block scripts %}
<script src="{% static 'assests/js/dashboard.js' %}" defer></script>
{% endblock scripts %}
